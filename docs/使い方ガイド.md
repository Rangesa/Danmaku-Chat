# DanmakuChat 使い方ガイド

**バージョン**: 1.0.0
**Minecraft**: 1.21.8
**Mod Loader**: Fabric

---

## 目次

1. [インストール方法](#インストール方法)
2. [基本的な使い方](#基本的な使い方)
3. [コマンド一覧](#コマンド一覧)
4. [設定項目](#設定項目)
5. [よくある質問](#よくある質問)

---

## インストール方法

### 必要なもの

1. **Minecraft 1.21.8** (Java Edition)
2. **Fabric Loader 0.16.14以上**
3. **Fabric API 0.129.0+1.21.8以上**

### インストール手順

1. **Fabric Loaderをインストール**
   - [Fabric公式サイト](https://fabricmc.net/use/)からインストーラーをダウンロード
   - Minecraft 1.21.8用のFabric Loaderをインストール

2. **Fabric APIをダウンロード**
   - [CurseForge](https://www.curseforge.com/minecraft/mc-mods/fabric-api)または[Modrinth](https://modrinth.com/mod/fabric-api)からダウンロード
   - バージョン: 0.129.0+1.21.8以上

3. **DanmakuChatをインストール**
   - `DanmakuChat-1.0.0.jar`をダウンロード
   - Minecraftの`mods`フォルダに配置
     - Windows: `%appdata%\.minecraft\mods`
     - Mac: `~/Library/Application Support/minecraft/mods`
     - Linux: `~/.minecraft/mods`

4. **Minecraftを起動**
   - Fabricプロファイルでゲームを起動
   - タイトル画面の「Mods」ボタンで「DanmakuChat」が表示されていればOK

---

## 基本的な使い方

### 弾幕チャットとは？

DanmakuChatは、ニコニコ動画のような「弾幕コメント」をMinecraftに実装するModです。

- **チャットメッセージが画面右から左へ流れます**
- **複数のメッセージが同時に表示されます**
- **衝突回避アルゴリズムでメッセージが重なりません**

### デフォルト設定

初回起動時は以下の設定になっています：

- **弾幕表示**: ON
- **バニラチャット**: 非表示
- **ユーザーチャット**: 表示（`<プレイヤー名> メッセージ`形式）
- **システムチャット**: 非表示（サーバーメッセージ、コマンド結果など）
- **スクロール速度**: 1.0（100px/秒）
- **表示レーン数**: 10レーン

### 初めて使うとき

1. **サーバーまたはワールドに参加**
2. **チャットを送信**してみる
3. **画面右から左へメッセージが流れます**

通常のチャット欄（画面左下）は非表示になり、代わりに画面上部にニコニコ動画風の弾幕が表示されます。

---

## コマンド一覧

すべてのコマンドは`/danmaku`で始まります。

### 基本コマンド

#### 現在の設定を確認

```
/danmaku
```

現在の設定状態を表示します。

**出力例**:
```
DanmakuChat Status:
Enabled: true
Hide Vanilla Chat: true
Scroll Speed: 1.0x
Display Duration: 5.0s
Max Lanes: 10
Show System Chat: false
Show User Chat: true
```

---

### 機能のON/OFF

#### 弾幕機能を有効化

```
/danmaku enable
```

弾幕チャットを有効にします。

#### 弾幕機能を無効化

```
/danmaku disable
```

弾幕チャットを無効にします。通常のチャット表示に戻ります。

---

### チャットの表示設定

#### ユーザーチャットの表示/非表示

```
/danmaku user true   # 表示
/danmaku user false  # 非表示
```

プレイヤーが送信したチャット（`<Player> メッセージ`形式）の表示を切り替えます。

**デフォルト**: `true`（表示）

#### システムチャットの表示/非表示

```
/danmaku system true   # 表示
/danmaku system false  # 非表示
```

サーバーメッセージやコマンド結果などの表示を切り替えます。

**デフォルト**: `false`（非表示）

**例**:
- `Player joined the game`
- `Player left the game`
- コマンドの実行結果
- サーバーのアナウンス

---

### 表示設定の調整

#### スクロール速度の変更

```
/danmaku speed <速度>
```

メッセージのスクロール速度を変更します。

**範囲**: 0.1 〜 5.0
**デフォルト**: 1.0（100px/秒）

**例**:
```
/danmaku speed 0.5   # ゆっくり（50px/秒）
/danmaku speed 1.0   # 通常（100px/秒）
/danmaku speed 2.0   # 速い（200px/秒）
```

#### レーン数の変更

```
/danmaku lanes <レーン数>
```

同時に表示できるメッセージのレーン数を変更します。

**範囲**: 1 〜 20
**デフォルト**: 10

**例**:
```
/danmaku lanes 5    # レーン数を5に減らす（シンプル）
/danmaku lanes 10   # デフォルト
/danmaku lanes 15   # レーン数を増やす（高密度）
```

---

### その他の設定

#### バニラチャットの表示/非表示

```
/danmaku vanilla true   # バニラチャットを表示
/danmaku vanilla false  # バニラチャットを非表示
```

画面左下の通常のチャット欄の表示を切り替えます。

**デフォルト**: `false`（非表示）

**使用例**:
- 弾幕とバニラチャットを両方表示したい場合: `true`
- 弾幕のみ表示したい場合: `false`

---

## 設定項目

設定は`config/danmakuchat.json`に保存されます。コマンドで変更した設定は自動的に保存されます。

### 設定ファイルの例

```json
{
  "enabled": true,
  "hideVanillaChat": true,
  "scrollSpeed": 1.0,
  "displayDuration": 5.0,
  "maxLanes": 10,
  "opacity": 0.8,
  "fontSize": 1.0,
  "discordIntegration": false,
  "showSystemChat": false,
  "showUserChat": true
}
```

### 各設定項目の説明

| 項目 | 説明 | デフォルト値 | 範囲 |
|------|------|--------------|------|
| `enabled` | 弾幕機能の有効/無効 | `true` | `true`/`false` |
| `hideVanillaChat` | バニラチャットを非表示にするか | `true` | `true`/`false` |
| `scrollSpeed` | スクロール速度（倍率） | `1.0` | 0.1 〜 5.0 |
| `displayDuration` | 表示時間（秒）※現在未使用 | `5.0` | 1.0 〜 30.0 |
| `maxLanes` | 最大レーン数 | `10` | 1 〜 20 |
| `opacity` | 不透明度 ※現在未使用 | `0.8` | 0.0 〜 1.0 |
| `fontSize` | フォントサイズ ※現在未使用 | `1.0` | 0.5 〜 2.0 |
| `discordIntegration` | Discord連携 ※未実装 | `false` | `true`/`false` |
| `showSystemChat` | システムチャット表示 | `false` | `true`/`false` |
| `showUserChat` | ユーザーチャット表示 | `true` | `true`/`false` |

**注**: ※印の項目は将来の拡張用に予約されています。

---

## よくある質問

### Q1: メッセージが表示されません

**確認事項**:

1. 弾幕機能が有効になっているか確認
   ```
   /danmaku
   ```
   `Enabled: true`になっているか確認

2. ユーザーチャットが有効になっているか確認
   ```
   /danmaku user true
   ```

3. Modが正しくロードされているか確認
   - タイトル画面の「Mods」ボタンでDanmakuChatが表示されるか確認
   - ログに`DanmakuChat initialized successfully!`が出力されているか確認

### Q2: メッセージが重なってしまいます

通常は衝突回避アルゴリズムによってメッセージが重ならないようになっています。

**対処法**:

1. レーン数を増やす
   ```
   /danmaku lanes 15
   ```

2. スクロール速度を上げる
   ```
   /danmaku speed 1.5
   ```

### Q3: メッセージが速すぎて読めません

スクロール速度を下げてください：

```
/danmaku speed 0.5
```

### Q4: バニラチャットも一緒に表示したい

バニラチャットを有効にしてください：

```
/danmaku vanilla true
```

弾幕とバニラチャットの両方が表示されます。

### Q5: システムメッセージ（参加/退出など）も弾幕で見たい

システムチャットを有効にしてください：

```
/danmaku system true
```

### Q6: 設定が保存されません

設定は自動的に`config/danmakuchat.json`に保存されます。

**確認事項**:

1. ファイルへの書き込み権限があるか確認
2. ログにエラーメッセージが出ていないか確認

手動で設定ファイルを編集した場合は、Minecraftを再起動してください。

### Q7: 他のチャットModと競合しますか？

DanmakuChatはチャットの**表示**のみを変更し、チャット機能自体は変更しません。

**互換性**:
- ✅ チャット拡張Mod（履歴、補完など）: 互換性あり
- ⚠️ チャットHUD変更Mod: 競合する可能性あり
- ✅ コマンド追加Mod: 互換性あり

### Q8: パフォーマンスへの影響は？

DanmakuChatは軽量に設計されています。

**パフォーマンス**:
- FPS影響: ほぼなし（60FPS維持）
- メモリ使用量: 微増（数百バイト）
- CPU使用量: 最小限

大量のチャットが流れる場合でも、衝突回避アルゴリズムによって適切に制御されます。

### Q9: マルチプレイで使えますか？

はい、クライアント側のModなので**サーバーにインストール不要**です。

**動作**:
- ✅ バニラサーバー: 動作します
- ✅ Fabricサーバー: 動作します
- ✅ Spigot/Paperサーバー: 動作します
- ✅ 他のプレイヤーに影響なし: 自分だけ弾幕表示されます

### Q10: アンインストール方法は？

1. `mods`フォルダから`DanmakuChat-1.0.0.jar`を削除
2. （任意）`config/danmakuchat.json`を削除

---

## トラブルシューティング

### ログの確認方法

問題が発生した場合、ログを確認してください。

**ログファイル**: `logs/latest.log`

**DanmakuChat関連のログを検索**:
```
[danmakuchat]
```

### よくあるエラーメッセージ

#### `Failed to load DanmakuChat config`

設定ファイルの読み込みに失敗しました。

**対処法**:
1. `config/danmakuchat.json`を削除
2. Minecraftを再起動（自動的に再生成されます）

#### `Failed to save DanmakuChat config`

設定ファイルの保存に失敗しました。

**対処法**:
1. `config`フォルダへの書き込み権限を確認
2. ディスクの空き容量を確認

---

## サポート

### バグ報告

バグを見つけた場合は、以下の情報と共に報告してください：

1. **Minecraftバージョン**
2. **DanmakuChatバージョン**
3. **問題の詳細**
4. **再現手順**
5. **ログファイル**（`logs/latest.log`）

### 機能リクエスト

新しい機能の提案も歓迎します！

---

## 今後の予定

### Phase 2 (計画中)

- フォントサイズ調整
- 透明度調整
- カラーカスタマイズ
- Mod Menu統合（GUI設定画面）

### Phase 3 (計画中)

- Discord連携
- 外部チャットの表示

---

**最終更新**: 2025-11-14
**作成者**: Claude Code
**ライセンス**: MIT
